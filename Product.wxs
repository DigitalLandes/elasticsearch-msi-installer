<?xml version="1.0" encoding="UTF-8"?>
<!-- DO NOT EDIT THIS FILE -->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="2b07b100-a66a-4280-839d-229ce63a9318" Name="Elasticsearch Windows Service" Language="1033" Version="$(var.EsiVersion)" Manufacturer="Installer by Hendrik Saly" UpgradeCode="4487b100-a66a-4280-839d-d29ce63a931d">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" Platform="x64" />

		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<MediaTemplate />

 
    
		<Feature Id="ProductFeature" Title="ESI" Level="1">
			<ComponentGroupRef Id="MyFiles" />
		</Feature>

    <Condition Message="This application is only supported on 64bit Windows (Win7/2008 or higher).">
      <![CDATA[Installed OR (VersionNT64 >= 601)]]>
    </Condition>

  
    <CustomAction Id="BatchCmd" ExeCommand="[INSTALLDIR]$(var.EsFolder)\bin\esi_service.bat" Directory="INSTALLDIR" Execute="deferred" Return="check" Impersonate="no"/>
    <CustomAction Id="BatchCmdU" ExeCommand="[INSTALLDIR]$(var.EsFolder)\bin\esi_service_uninstall.bat" Directory="INSTALLDIR" Execute="deferred" Return="ignore" Impersonate="no"/>

    <InstallExecuteSequence>
      <Custom Action="BatchCmd" After="InstallFiles" >Not Installed </Custom>
      <Custom Action="BatchCmdU" Before="RemoveFiles">Installed AND NOT REINSTALL</Custom>
    </InstallExecuteSequence>
    
    
	</Product>

	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFiles64Folder">
				<Directory Id="INSTALLDIR" Name="Elasticsearch" />
			</Directory>
		</Directory>
	</Fragment>


</Wix>